{"version":3,"sources":["../../../javascript/src/filter.js"],"names":[],"mappings":";;;;;;;;QAiBgB,Y,GAAA,Y;;AAjBhB;;;;;;;;AAEA,SAAS,YAAT,CAAsB,KAAtB,EAA6B;AAC3B,MAAI,QAAQ,MAAM,GAAN,CAAU,WAAV,CAAZ;AACA,MAAI,SAAS,MAAM,GAAN,EAAb;AACA,MAAI,CAAC,MAAL,EAAa;AACX,aAAS,yBAAT;AACA,UAAM,GAAN,CAAU,MAAV;AACD;AACD,SAAO,MAAP;AACD;;AAED,IAAI,KAAK,CAAT;AACA,SAAS,MAAT,GAAkB;AAChB,SAAO,IAAP;AACD;;AAEM,SAAS,YAAT,CAAsB,KAAtB,EAA6B;AAClC,SAAO,IAAI,YAAJ,CACL,aAAa,KAAb,CADK,EAEL,MAAM,GAAN,CAAU,QAAV,CAFK,CAAP;AAID;;IAEK,Y;AACJ,wBAAY,SAAZ,EAAuB,SAAvB,EAAkE;AAAA,QAAhC,QAAgC,yDAArB,WAAW,QAAU;;AAAA;;AAChE,SAAK,UAAL,GAAkB,SAAlB;AACA,SAAK,UAAL,GAAkB,SAAlB;AACA,SAAK,GAAL,GAAW,QAAX;AACD;;;;4BAEO;AACN,WAAK,KAAL;AACD;;;4BAEO;AACN,WAAK,UAAL,CAAgB,KAAhB,CAAsB,KAAK,GAA3B;AACA,WAAK,SAAL;AACD;;;wBAEG,I,EAAM;AACR,WAAK,UAAL,CAAgB,MAAhB,CAAuB,KAAK,GAA5B,EAAiC,IAAjC;AACA,WAAK,SAAL;AACD;;;uBAME,S,EAAW,Q,EAAU;AACtB,aAAO,KAAK,UAAL,CAAgB,EAAhB,CAAmB,SAAnB,EAA8B,QAA9B,CAAP;AACD;;;gCAEW;AACV,WAAK,UAAL,CAAgB,GAAhB,CAAoB,KAAK,UAAL,CAAgB,KAApC;AACD;;;wBAVkB;AACjB,aAAO,KAAK,UAAL,CAAgB,KAAvB;AACD","file":"filter.js","sourcesContent":["import FilterSet from \"./filterset\";\n\nfunction getFilterSet(group) {\n  let fsVar = group.var(\"filterset\");\n  let result = fsVar.get();\n  if (!result) {\n    result = new FilterSet();\n    fsVar.set(result);\n  }\n  return result;\n}\n\nlet id = 1;\nfunction nextId() {\n  return id++;\n}\n\nexport function createHandle(group) {\n  return new FilterHandle(\n    getFilterSet(group),\n    group.var(\"filter\")\n  );\n}\n\nclass FilterHandle {\n  constructor(filterSet, filterVar, handleId = \"filter\" + nextId()) {\n    this._filterSet = filterSet;\n    this._filterVar = filterVar;\n    this._id = handleId;\n  }\n\n  close() {\n    this.clear();\n  }\n\n  clear() {\n    this._filterSet.clear(this._id);\n    this._onChange();\n  }\n\n  set(keys) {\n    this._filterSet.update(this._id, keys);\n    this._onChange();\n  }\n\n  get filteredKeys() {\n    return this._filterSet.value;\n  }\n\n  on(eventType, listener) {\n    return this._filterVar.on(eventType, listener);\n  }\n\n  _onChange() {\n    this._filterVar.set(this._filterSet.value);\n  }\n}\n"]}